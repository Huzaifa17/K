this has some problems like event handling after notification.
